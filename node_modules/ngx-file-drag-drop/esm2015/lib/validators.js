// @dynamic
export class FileValidators {
    static fileExtension(ext) {
        return (control) => {
            const validExtensions = ext.map(e => e.trim().toLowerCase());
            const fileArray = control.value;
            const invalidFiles = fileArray.map(file => file.name).filter(fname => {
                const extension = fname.slice((fname.lastIndexOf('.') - 1 >>> 0) + 2).toLowerCase();
                return !validExtensions.includes(extension);
            }).map(name => ({ name, ext: name.slice((name.lastIndexOf('.') - 1 >>> 0) + 2) }));
            return !invalidFiles.length
                ? null
                : {
                    fileExtension: {
                        requiredExtension: ext.toString(),
                        actualExtensions: invalidFiles
                    }
                };
        };
    }
    static uniqueFileNames(control) {
        const fileNameArray = control.value.map(file => file.name);
        const duplicates = fileNameArray.reduce((acc, curr) => {
            acc[curr] = acc[curr] ? acc[curr] + 1 : 1;
            return acc;
        }, {});
        const duplicatesArray = Object.entries(duplicates)
            .filter(arr => arr[1] > 1)
            .map(arr => ({ name: arr[0], count: arr[1] }));
        return !duplicatesArray.length
            ? null
            : {
                uniqueFileNames: { duplicatedFileNames: duplicatesArray }
            };
    }
    static fileType(types) {
        return (control) => {
            let regExp;
            if (Array.isArray(types)) {
                const joinedTypes = types.join('$|^');
                regExp = new RegExp(`$${joinedTypes}^`, 'i');
            }
            else {
                regExp = types;
            }
            const fileArray = control.value;
            const invalidFiles = fileArray.filter(file => !regExp.test(file.type)).map(file => ({ name: file.name, type: file.type }));
            return !invalidFiles.length
                ? null
                : {
                    fileType: {
                        requiredType: types.toString(),
                        actualTypes: invalidFiles
                    }
                };
        };
    }
    static maxFileCount(count) {
        return (control) => {
            const fileCount = (control === null || control === void 0 ? void 0 : control.value) ? control.value.length : 0;
            const result = count >= fileCount;
            return result
                ? null
                : {
                    maxFileCount: {
                        maxCount: count,
                        actualCount: fileCount
                    }
                };
        };
    }
    static maxFileSize(bytes) {
        return (control) => {
            const fileArray = control.value;
            const invalidFiles = fileArray.filter(file => file.size > bytes).map(file => ({ name: file.name, size: file.size }));
            return !invalidFiles.length
                ? null
                : {
                    maxFileSize: {
                        maxSize: bytes,
                        actualSizes: invalidFiles
                    }
                };
        };
    }
    static maxTotalSize(bytes) {
        return (control) => {
            const size = (control === null || control === void 0 ? void 0 : control.value) ? control.value.map(file => file.size).reduce((acc, i) => acc + i, 0) : 0;
            const result = bytes >= size;
            return result
                ? null
                : {
                    maxTotalSize: {
                        maxSize: bytes,
                        actualSize: size
                    }
                };
        };
    }
    static required(control) {
        var _a;
        const count = (_a = control === null || control === void 0 ? void 0 : control.value) === null || _a === void 0 ? void 0 : _a.length;
        return count
            ? null
            : {
                required: true
            };
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmFsaWRhdG9ycy5qcyIsInNvdXJjZVJvb3QiOiJDOi9Vc2Vycy9lbW1iZS9EZXNrdG9wL25neC1maWxlLWRyYWctZHJvcC9wcm9qZWN0cy9uZ3gtZmlsZS1kcmFnLWRyb3Avc3JjLyIsInNvdXJjZXMiOlsibGliL3ZhbGlkYXRvcnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUEsV0FBVztBQUNYLE1BQU0sT0FBTyxjQUFjO0lBQ3ZCLE1BQU0sQ0FBQyxhQUFhLENBQUMsR0FBYTtRQUM5QixPQUFPLENBQUMsT0FBd0IsRUFBMkIsRUFBRTtZQUV6RCxNQUFNLGVBQWUsR0FBRyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUM7WUFDN0QsTUFBTSxTQUFTLEdBQUksT0FBTyxDQUFDLEtBQWdCLENBQUM7WUFFNUMsTUFBTSxZQUFZLEdBQUcsU0FBUyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQ3hELEtBQUssQ0FBQyxFQUFFO2dCQUNKLE1BQU0sU0FBUyxHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztnQkFDcEYsT0FBTyxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDaEQsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxF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QkFBUCxPQUFPLENBQUUsS0FBSyxFQUFDLENBQUMsQ0FBRSxPQUFPLENBQUMsS0FBZ0IsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsR0FBRyxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2xILE1BQU0sTUFBTSxHQUFHLEtBQUssSUFBSSxJQUFJLENBQUM7WUFDN0IsT0FBTyxNQUFNO2dCQUNULENBQUMsQ0FBQyxJQUFJO2dCQUNOLENBQUMsQ0FBQztvQkFDRSxZQUFZLEVBQUU7d0JBQ1YsT0FBTyxFQUFFLEtBQUs7d0JBQ2QsVUFBVSxFQUFFLElBQUk7cUJBQ25CO2lCQUNKLENBQUM7UUFDVixDQUFDLENBQUM7SUFDTixDQUFDO0lBQ0QsTUFBTSxDQUFDLFFBQVEsQ0FBQyxPQUF3Qjs7UUFDcEMsTUFBTSxLQUFLLFNBQUcsT0FBTyxhQUFQLE9BQU8sdUJBQVAsT0FBTyxDQUFFLEtBQUssMENBQUUsTUFBTSxDQUFDO1FBQ3JDLE9BQU8sS0FBSztZQUNSLENBQUMsQ0FBQyxJQUFJO1lBQ04sQ0FBQyxDQUFDO2dCQUNFLFFBQVEsRUFBRSxJQUFJO2FBQ2pCLENBQUM7SUFDVixDQUFDO0NBQ0oiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWYWxpZGF0b3JGbiwgQWJzdHJhY3RDb250cm9sLCBWYWxpZGF0aW9uRXJyb3JzIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xyXG5cclxuLy8gQGR5bmFtaWNcclxuZXhwb3J0IGNsYXNzIEZpbGVWYWxpZGF0b3JzIHtcclxuICAgIHN0YXRpYyBmaWxlRXh0ZW5zaW9uKGV4dDogc3RyaW5nW10pOiBWYWxpZGF0b3JGbiB7XHJcbiAgICAgICAgcmV0dXJuIChjb250cm9sOiBBYnN0cmFjdENvbnRyb2wpOiBWYWxpZGF0aW9uRXJyb3JzIHwgbnVsbCA9PiB7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB2YWxpZEV4dGVuc2lvbnMgPSBleHQubWFwKGUgPT4gZS50cmltKCkudG9Mb3dlckNhc2UoKSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGZpbGVBcnJheSA9IChjb250cm9sLnZhbHVlIGFzIEZpbGVbXSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBpbnZhbGlkRmlsZXMgPSBmaWxlQXJyYXkubWFwKGZpbGUgPT4gZmlsZS5uYW1lKS5maWx0ZXIoXHJcbiAgICAgICAgICAgICAgICBmbmFtZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXh0ZW5zaW9uID0gZm5hbWUuc2xpY2UoKGZuYW1lLmxhc3RJbmRleE9mKCcuJykgLSAxID4+PiAwKSArIDIpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICF2YWxpZEV4dGVuc2lvbnMuaW5jbHVkZXMoZXh0ZW5zaW9uKTtcclxuICAgICAgICAgICAgICAgIH0pLm1hcChuYW1lID0+ICh7IG5hbWUsIGV4dDogbmFtZS5zbGljZSgobmFtZS5sYXN0SW5kZXhPZignLicpIC0gMSA+Pj4gMCkgKyAyKSB9KSk7XHJcblxyXG5cclxuXHJcbiAgICAgICAgICAgIHJldHVybiAhaW52YWxpZEZpbGVzLmxlbmd0aFxyXG4gICAgICAgICAgICAgICAgPyBudWxsXHJcbiAgICAgICAgICAgICAgICA6IHtcclxuICAgICAgICAgICAgICAgICAgICBmaWxlRXh0ZW5zaW9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkRXh0ZW5zaW9uOiBleHQudG9TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0dWFsRXh0ZW5zaW9uczogaW52YWxpZEZpbGVzXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyB1bmlxdWVGaWxlTmFtZXMoY29udHJvbDogQWJzdHJhY3RDb250cm9sKTogVmFsaWRhdGlvbkVycm9ycyB8IG51bGwge1xyXG5cclxuICAgICAgICBjb25zdCBmaWxlTmFtZUFycmF5ID0gKGNvbnRyb2wudmFsdWUgYXMgRmlsZVtdKS5tYXAoZmlsZSA9PiBmaWxlLm5hbWUpO1xyXG5cclxuICAgICAgICBjb25zdCBkdXBsaWNhdGVzID0gZmlsZU5hbWVBcnJheS5yZWR1Y2UoKGFjYywgY3VycikgPT4ge1xyXG4gICAgICAgICAgICBhY2NbY3Vycl0gPSBhY2NbY3Vycl0gPyBhY2NbY3Vycl0gKyAxIDogMTtcclxuICAgICAgICAgICAgcmV0dXJuIGFjYztcclxuICAgICAgICB9LCB7fSk7XHJcblxyXG5cclxuXHJcbiAgICAgICAgY29uc3QgZHVwbGljYXRlc0FycmF5OiB7IG5hbWU6IHN0cmluZywgY291bnQ6IG51bWJlciB9W10gPSAoT2JqZWN0LmVudHJpZXMoZHVwbGljYXRlcykgYXMgW3N0cmluZywgbnVtYmVyXVtdKVxyXG4gICAgICAgICAgICAuZmlsdGVyKGFyciA9PiBhcnJbMV0gPiAxKVxyXG4gICAgICAgICAgICAubWFwKGFyciA9PiAoeyBuYW1lOiBhcnJbMF0sIGNvdW50OiBhcnJbMV0gfSkpO1xyXG5cclxuICAgICAgICByZXR1cm4gIWR1cGxpY2F0ZXNBcnJheS5sZW5ndGhcclxuICAgICAgICAgICAgPyBudWxsXHJcbiAgICAgICAgICAgIDoge1xyXG4gICAgICAgICAgICAgICAgdW5pcXVlRmlsZU5hbWVzOiB7IGR1cGxpY2F0ZWRGaWxlTmFtZXM6IGR1cGxpY2F0ZXNBcnJheSB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGZpbGVUeXBlKHR5cGVzOiBzdHJpbmdbXSB8IFJlZ0V4cCk6IFZhbGlkYXRvckZuIHtcclxuICAgICAgICByZXR1cm4gKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCk6IFZhbGlkYXRpb25FcnJvcnMgfCBudWxsID0+IHtcclxuXHJcbiAgICAgICAgICAgIGxldCByZWdFeHA6IFJlZ0V4cDtcclxuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodHlwZXMpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBqb2luZWRUeXBlcyA9IHR5cGVzLmpvaW4oJyR8XicpO1xyXG4gICAgICAgICAgICAgICAgcmVnRXhwID0gbmV3IFJlZ0V4cChgJCR7am9pbmVkVHlwZXN9XmAsICdpJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZWdFeHAgPSB0eXBlcztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3QgZmlsZUFycmF5ID0gKGNvbnRyb2wudmFsdWUgYXMgRmlsZVtdKTtcclxuXHJcblxyXG5cclxuICAgICAgICAgICAgY29uc3QgaW52YWxpZEZpbGVzID0gZmlsZUFycmF5LmZpbHRlcihcclxuICAgICAgICAgICAgICAgIGZpbGUgPT4gIXJlZ0V4cC50ZXN0KGZpbGUudHlwZSkpLm1hcChmaWxlID0+ICh7IG5hbWU6IGZpbGUubmFtZSwgdHlwZTogZmlsZS50eXBlIH0pKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiAhaW52YWxpZEZpbGVzLmxlbmd0aFxyXG4gICAgICAgICAgICAgICAgPyBudWxsXHJcbiAgICAgICAgICAgICAgICA6IHtcclxuICAgICAgICAgICAgICAgICAgICBmaWxlVHlwZToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZFR5cGU6IHR5cGVzLnRvU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdHVhbFR5cGVzOiBpbnZhbGlkRmlsZXNcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG5cclxuXHJcbiAgICBzdGF0aWMgbWF4RmlsZUNvdW50KGNvdW50OiBudW1iZXIpOiBWYWxpZGF0b3JGbiB7XHJcbiAgICAgICAgcmV0dXJuIChjb250cm9sOiBBYnN0cmFjdENvbnRyb2wpOiBWYWxpZGF0aW9uRXJyb3JzIHwgbnVsbCA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDb3VudCA9IGNvbnRyb2w/LnZhbHVlID8gKGNvbnRyb2wudmFsdWUgYXMgRmlsZVtdKS5sZW5ndGggOiAwO1xyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBjb3VudCA+PSBmaWxlQ291bnQ7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHRcclxuICAgICAgICAgICAgICAgID8gbnVsbFxyXG4gICAgICAgICAgICAgICAgOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWF4RmlsZUNvdW50OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heENvdW50OiBjb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0dWFsQ291bnQ6IGZpbGVDb3VudFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgbWF4RmlsZVNpemUoYnl0ZXM6IG51bWJlcik6IFZhbGlkYXRvckZuIHtcclxuICAgICAgICByZXR1cm4gKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCk6IFZhbGlkYXRpb25FcnJvcnMgfCBudWxsID0+IHtcclxuXHJcblxyXG4gICAgICAgICAgICBjb25zdCBmaWxlQXJyYXkgPSAoY29udHJvbC52YWx1ZSBhcyBGaWxlW10pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgaW52YWxpZEZpbGVzID0gZmlsZUFycmF5LmZpbHRlcihmaWxlID0+IGZpbGUuc2l6ZSA+IGJ5dGVzKS5tYXAoZmlsZSA9PiAoeyBuYW1lOiBmaWxlLm5hbWUsIHNpemU6IGZpbGUuc2l6ZSB9KSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gIWludmFsaWRGaWxlcy5sZW5ndGhcclxuICAgICAgICAgICAgICAgID8gbnVsbFxyXG4gICAgICAgICAgICAgICAgOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWF4RmlsZVNpemU6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4U2l6ZTogYnl0ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdHVhbFNpemVzOiBpbnZhbGlkRmlsZXNcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIG1heFRvdGFsU2l6ZShieXRlczogbnVtYmVyKTogVmFsaWRhdG9yRm4ge1xyXG4gICAgICAgIHJldHVybiAoY29udHJvbDogQWJzdHJhY3RDb250cm9sKTogVmFsaWRhdGlvbkVycm9ycyB8IG51bGwgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBzaXplID0gY29udHJvbD8udmFsdWUgPyAoY29udHJvbC52YWx1ZSBhcyBGaWxlW10pLm1hcChmaWxlID0+IGZpbGUuc2l6ZSkucmVkdWNlKChhY2MsIGkpID0+IGFjYyArIGksIDApIDogMDtcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYnl0ZXMgPj0gc2l6ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdFxyXG4gICAgICAgICAgICAgICAgPyBudWxsXHJcbiAgICAgICAgICAgICAgICA6IHtcclxuICAgICAgICAgICAgICAgICAgICBtYXhUb3RhbFNpemU6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4U2l6ZTogYnl0ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdHVhbFNpemU6IHNpemVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgcmVxdWlyZWQoY29udHJvbDogQWJzdHJhY3RDb250cm9sKTogVmFsaWRhdGlvbkVycm9ycyB8IG51bGwge1xyXG4gICAgICAgIGNvbnN0IGNvdW50ID0gY29udHJvbD8udmFsdWU/Lmxlbmd0aDtcclxuICAgICAgICByZXR1cm4gY291bnRcclxuICAgICAgICAgICAgPyBudWxsXHJcbiAgICAgICAgICAgIDoge1xyXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWVcclxuICAgICAgICAgICAgfTtcclxuICAgIH1cclxufVxyXG4iXX0=